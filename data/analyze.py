#! python3
import pandas as pd

data = """
MeteringpointID,AT9990000991100000000000209351633,AT9990000991100000000000209351633,AT9990000991100000000000209351633,AT9990000991100000000000209351644,AT9990000991100000000000209351644,AT9990000991100000000000209351644,AT9990000991100000000007000091655,AT9990000991100000000007000091655,AT9990000991100000000007000091655,AT9990000991100000000099000003411,TOTAL,TOTAL,TOTAL
01.01.2021 00:00:00,0.662000,0.000000,0.000000,0.418000,0.000000,0.000000,0.398000,0.000000,0.000000,0.000000,1.478000,0.000000,0.000000
01.01.2021 00:15:00,0.678000,0.000000,0.000000,0.418000,0.000000,0.000000,0.404000,0.000000,0.000000,0.000000,1.500000,0.000000,0.000000
01.01.2021 00:30:00,0.214000,0.000000,0.000000,0.424000,0.000000,0.000000,0.407000,0.000000,0.000000,0.000000,1.045000,0.000000,0.000000
01.01.2021 00:45:00,0.070000,0.000000,0.000000,0.439000,0.000000,0.000000,0.403000,0.000000,0.000000,0.000000,0.912000,0.000000,0.000000
01.01.2021 01:00:00,0.063000,0.000000,0.000000,0.025000,0.000000,0.000000,0.411000,0.000000,0.000000,0.000000,0.499000,0.000000,0.000000
01.01.2021 01:15:00,0.082000,0.000000,0.000000,0.050000,0.000000,0.000000,0.439000,0.000000,0.000000,0.000000,0.571000,0.000000,0.000000
01.01.2021 01:30:00,0.112000,0.000000,0.000000,0.050000,0.000000,0.000000,0.393000,0.000000,0.000000,0.000000,0.555000,0.000000,0.000000
01.01.2021 01:45:00,0.114000,0.000000,0.000000,0.050000,0.000000,0.000000,0.403000,0.000000,0.000000,0.000000,0.567000,0.000000,0.000000
01.01.2021 02:00:00,0.085000,0.000000,0.000000,0.049000,0.000000,0.000000,0.406000,0.000000,0.000000,0.000000,0.540000,0.000000,0.000000
01.01.2021 02:15:00,0.080000,0.000000,0.000000,0.050000,0.000000,0.000000,0.402000,0.000000,0.000000,0.000000,0.532000,0.000000,0.000000
01.01.2021 02:30:00,0.064000,0.000000,0.000000,0.041000,0.000000,0.000000,0.442000,0.000000,0.000000,0.000000,0.547000,0.000000,0.000000
01.01.2021 02:45:00,0.114000,0.000000,0.000000,0.071000,0.000000,0.000000,0.401000,0.000000,0.000000,0.000000,0.586000,0.000000,0.000000
01.01.2021 03:00:00,0.055000,0.000000,0.000000,0.230000,0.000000,0.000000,0.392000,0.000000,0.000000,0.000000,0.677000,0.000000,0.000000
01.01.2021 03:15:00,0.245000,0.000000,0.000000,0.008000,0.000000,0.000000,0.354000,0.000000,0.000000,0.000000,0.607000,0.000000,0.000000
01.01.2021 03:30:00,0.064000,0.000000,0.000000,0.007000,0.000000,0.000000,0.354000,0.000000,0.000000,0.000000,0.425000,0.000000,0.000000
01.01.2021 03:45:00,0.080000,0.000000,0.000000,0.007000,0.000000,0.000000,0.364000,0.000000,0.000000,0.000000,0.451000,0.000000,0.000000
01.01.2021 04:00:00,0.094000,0.000000,0.000000,0.010000,0.000000,0.000000,0.358000,0.000000,0.000000,0.000000,0.462000,0.000000,0.000000
01.01.2021 04:15:00,0.095000,0.000000,0.000000,0.156000,0.000000,0.000000,0.354000,0.000000,0.000000,0.000000,0.605000,0.000000,0.000000
01.01.2021 04:30:00,0.242000,0.000000,0.000000,0.076000,0.000000,0.000000,0.351000,0.000000,0.000000,0.000000,0.669000,0.000000,0.000000
01.01.2021 04:45:00,0.060000,0.000000,0.000000,0.005000,0.000000,0.000000,0.134000,0.000000,0.000000,0.000000,0.199000,0.000000,0.000000
01.01.2021 05:00:00,0.092000,0.000000,0.000000,0.006000,0.000000,0.000000,0.055000,0.000000,0.000000,0.000000,0.153000,0.000000,0.000000
01.01.2021 05:15:00,0.062000,0.000000,0.000000,0.005000,0.000000,0.000000,0.017000,0.000000,0.000000,0.000000,0.084000,0.000000,0.000000
01.01.2021 05:30:00,0.099000,0.000000,0.000000,0.004000,0.000000,0.000000,0.021000,0.000000,0.000000,0.000000,0.124000,0.000000,0.000000
01.01.2021 05:45:00,0.083000,0.000000,0.000000,0.018000,0.000000,0.000000,0.020000,0.000000,0.000000,0.000000,0.121000,0.000000,0.000000
01.01.2021 06:00:00,0.092000,0.000000,0.000000,0.013000,0.000000,0.000000,0.016000,0.000000,0.000000,0.000000,0.121000,0.000000,0.000000
01.01.2021 06:15:00,0.058000,0.000000,0.000000,0.002000,0.000000,0.000000,0.016000,0.000000,0.000000,0.000000,0.076000,0.000000,0.000000
01.01.2021 06:30:00,0.104000,0.000000,0.000000,0.002000,0.000000,0.000000,0.016000,0.000000,0.000000,0.000000,0.122000,0.000000,0.000000
01.01.2021 06:45:00,0.062000,0.000000,0.000000,0.002000,0.000000,0.000000,0.016000,0.000000,0.000000,0.000000,0.080000,0.000000,0.000000
01.01.2021 07:00:00,0.063000,0.000000,0.000000,0.002000,0.000000,0.000000,0.016000,0.000000,0.000000,0.000000,0.081000,0.000000,0.000000
01.01.2021 07:15:00,0.100000,0.000000,0.000000,0.008000,0.000000,0.000000,0.018000,0.000000,0.000000,0.000000,0.126000,0.000000,0.000000
01.01.2021 07:30:00,0.090000,0.000000,0.000000,0.018000,0.000000,0.000000,0.025000,0.000000,0.000000,0.000000,0.133000,0.000000,0.000000
01.01.2021 07:45:00,0.100000,0.000000,0.000000,0.006000,0.000000,0.000000,0.160000,0.000000,0.000000,0.000000,0.266000,0.000000,0.000000
01.01.2021 08:00:00,0.068000,0.000000,0.000000,0.002000,0.000000,0.000000,0.139000,0.000000,0.000000,0.000000,0.209000,0.000000,0.000000
"""


def read_data(csv_data, metering_point):
    """
   use pandas to aggregate metering data per day
    """

    #data_df = pd.read_csv(csv_data, sep=",")

    # rename columns to be used in calculations
    data_df.columns = [
        "day",
        "1_l1_a",
        "1_l1_r",
        "1_l1_s",
        "1_l2_a",
        "1_l2_r",
        "1_l2_s",
        "2_l1_a",
        "2_l1_r",
        "2_l1_s",
        "2_l2_a",
        "2_total_a",
        "2_total_r",
        "2_total_s",
    ]

    # select one metering point
    data_df = data_df[["day", "2_l2_a"]]

    # sum values per day
    data_df = data_df.groupby(["day"]).sum()

    # reset index to use as dataframe column
    data_df = data_df.reset_index()

    # rename columns to be used later on
    data_df.columns = ["day", "total_energy"]

    # convert to kWh from Wh
    data_df["total_energy"] = data_df["total_energy"] / 1000

    # set decimal places
    data_df["total_energy"] = data_df["total_energy"].round(2)

    # print(data_df)
    return data_df

read_data(data, "AT9990000991100000000000209351633")
